<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="/WEB-INF/templates/template.xhtml">

	<ui:define name="title">
		<h:outputText
			value="Patient: #{patientProfileView.fullName} - #{visitView.service.selected.vstDate}" />
	</ui:define>

	<ui:define name="content">
		<p:panel id="bigPanel">
			<f:facet name="header">
				<p:panelGrid columns="4" style="width: 100%">
					<p:outputLabel value="Patient Name: " />
					<p:outputLabel value="#{patientProfileView.fullName}" />
					<p:outputLabel value="Patient Number: " />
					<p:outputLabel
						value="#{patientProfileView.patientService.selected.pid}" />
				</p:panelGrid>
			</f:facet>
			<div style="width: 100%; height: 100%">
				<p:dashboard id="board" model="#{visitView.dashboardModel}">
					<p:panel id="symptoms" header="symptoms">
						<h:form id="smptmFrm">
							<p:growl id="msgs" showDetail="true" />
							<p:dataTable id="hsSmptmDtId"
								value="#{hasSymptomView.service.list}"
								selection="#{hasSymptomView.service.selected}"
								selectionMode="single" var="smp" rowKey="#{smp.id}">
								<p:ajax event="rowSelect" update="smptmEditBtn, smptmDeleteBtn" />
								<p:ajax event="rowUnselect"
									update="smptmEditBtn, smptmDeleteBtn" />
								<p:column headerText="Name">
									<h:outputText value="#{smp.symptom.name}" />
								</p:column>
								<p:column headerText="Repetation">
									<h:outputText value="#{smp.repetation}" />
								</p:column>
								<p:column headerText="Severity">
									<h:outputText value="#{smp.severity}" />
								</p:column>
								<p:column headerText="Start date">
									<h:outputText value="#{smp.startDate}">
										<f:convertDateTime pattern="dd/MM/yyyy HH:mm" />
									</h:outputText>
								</p:column>
								<p:column headerText="Notes">
									<h:outputText value="#{smp.notes}" />
								</p:column>
								<f:facet name="footer">
									<p:commandButton value="Add" icon="fa fa-plus" process="@this"
										actionListener="#{hasSymptomView.onAddButtonClicked}"
										update="@widgetVar(smptmDlgWv)"
										oncomplete="PF('smptmDlgWv').show()" />
									<p:commandButton value="Edit" icon="fa fa-pencil"
										process="@this" id="smptmEditBtn"
										actionListener="#{hasSymptomView.onEditButtonClicked}"
										update="@widgetVar(smptmDlgWv)"
										disabled="#{hasSymptomView.service.selected eq null}"
										oncomplete="PF('smptmDlgWv').show()" />
									<p:commandButton value="Delete" icon="fa fa-remove"
										process="@this" id="smptmDeleteBtn" update="@form"
										disabled="#{hasSymptomView.service.selected eq null}"
										actionListener="#{hasSymptomView.onDeleteButtonClicked}">
										<p:confirm header="Confirmation"
											message="Are you sure you want to delete #{hasSymptomView.service.selected.symptom.name}"
											icon="fa fa-remove" />
									</p:commandButton>
								</f:facet>
							</p:dataTable>

							<p:dialog id="smptmDlg" widgetVar="smptmDlgWv" modal="true"
								closable="false">
								<p:panelGrid id="smptmPanel" columns="2"
									columnClasses="label, value">
									<p:outputLabel value="Symptom: " for="smptmName" />
									<p:autoComplete id="smptmName" required="true"
										requiredMessage="Symptom name is manadotry."
										value="#{hasSymptomView.service.selected.symptom}"
										completeMethod="#{hasSymptomView.completeSymptom}" var="sm"
										itemLabel="#{sm.name}" itemValue="#{sm}" forceSelection="true"
										maxResults="12" converter="symptomConveter" />
									<p:outputLabel value="Repetation:" for="smptmRep" />
									<p:selectOneButton id="smptmRep"
										value="#{hasSymptomView.service.selected.repetation}"
										required="true" requiredMessage="Repetation is manadotry">
										<f:selectItem itemLabel="Frequent" itemValue="Frequent" />
										<f:selectItem itemLabel="Average" itemValue="Average" />
										<f:selectItem itemLabel="Rare" itemValue="Rare" />
										<f:selectItem itemLabel="Once" itemValue="Once" />
									</p:selectOneButton>
									<p:outputLabel value="Severity:" for="smptmSev" />
									<p:selectOneButton id="smptmSev"
										value="#{hasSymptomView.service.selected.severity}"
										required="true" requiredMessage="Severity is manadotry">
										<f:selectItem itemLabel="Mild" itemValue="Mild" />
										<f:selectItem itemLabel="Moderate" itemValue="Moderate" />
										<f:selectItem itemLabel="Strong" itemValue="Strong" />
									</p:selectOneButton>
									<p:outputLabel value="Start Date:" for="smptmStDt" />
									<p:calendar id="smptmStDt" navigator="true" required="true"
										requiredMessage="Symptom start date is manadotry"
										value="#{hasSymptomView.service.selected.startDate}"
										pattern="dd/MM/yyyy HH:mm:ss" mask="true" effect="fade"
										locale="ar_SY" maxdate="#{visitView.service.selected.vstDate}" />
									<p:outputLabel value="Notes:" for="smptmNotes" />
									<p:inputTextarea id="smptmNotes"
										value="#{hasSymptomView.service.selected.notes}"
										maxlength="210" placeholder="notes" />
								</p:panelGrid>
								<f:facet name="footer">
									<p:commandButton id="smptmSave" value="Save" icon="fa fa-save"
										oncomplete="handelSmptmSaveRequest(xhr, status, args)"
										process="smptmPanel, @this"
										actionListener="#{hasSymptomView.onSaveButtonClicked}"
										update="smptmPanel, smptmFrm:hsSmptmDtId, smptmFrm:msgs" />
									<p:commandButton id="smptmCancel" value="Cancel"
										process="@this"
										update="smptmPanel, smptmFrm:hsSmptmDtId, smptmFrm:msgs"
										actionListener="#{hasSymptomView.onCancelButtonClicked}"
										icon="fa fa-remove" oncomplete="PF('smptmDlgWv').hide()">
										<p:resetInput target="smptmPanel" />
									</p:commandButton>
								</f:facet>
							</p:dialog>
							<script>
								function handelSmptmSaveRequest(xhr, status,
										args) {
									if (args.validationFailed) {
										PF('smptmDlgWv').jq.effect("shake", {
											times : 5
										}, 100);
									} else {
										PF('smptmDlgWv').hide();
									}
								}
							</script>
						</h:form>
					</p:panel>
					<p:panel id="measurments" header="measurments">
						<h:form id="msrmntFrm">
							<p:growl id="msgs" showDetail="true" />
							<p:dataTable id="dtId" value="#{tkMsrmntView.service.list}"
								selection="#{tkMsrmntView.service.selected}"
								selectionMode="single" var="item" rowKey="#{item.id}">
								<p:ajax event="rowSelect" update="editBtn, deleteBtn" />
								<p:ajax event="rowUnselect" update="editBtn, deleteBtn" />
								<p:column headerText="Measurment Name">
									<h:outputText value="#{item.measurment.name}" />
								</p:column>
								<p:column headerText="Value (Number)">
									<h:outputText value="#{item.numricalValue}" />
								</p:column>
								<p:column headerText="Value Text">
									<h:outputText value="#{item.textualValue}" />
								</p:column>
								<p:column headerText="Notes">
									<h:outputText value="#{item.notes}" />
								</p:column>
								<f:facet name="footer">
									<p:commandButton value="Add" icon="fa fa-plus" process="@this"
										actionListener="#{tkMsrmntView.onAddButtonClicked}"
										update="@widgetVar(msrmntDlgWv)"
										oncomplete="PF('msrmntDlgWv').show()" />
									<p:commandButton value="Edit" icon="fa fa-pencil"
										process="@this" id="editBtn"
										actionListener="#{tkMsrmntView.onEditButtonClicked}"
										update="@widgetVar(msrmntDlgWv)"
										disabled="#{tkMsrmntView.service.selected eq null}"
										oncomplete="PF('msrmntDlgWv').show()" />
									<p:commandButton value="Delete" icon="fa fa-remove"
										process="@this" id="deleteBtn" update="@form"
										disabled="#{tkMsrmntView.service.selected eq null}"
										actionListener="#{tkMsrmntView.onDeleteButtonClicked}">
										<p:confirm header="Confirmation"
											message="Are you sure you want to delete #{tkMsrmntView.service.selected.measurment.name}"
											icon="fa fa-remove" />
									</p:commandButton>
								</f:facet>
							</p:dataTable>
							<p:dialog id="msrmntDlg" widgetVar="msrmntDlgWv" modal="true"
								closable="false" showEffect="explode" hideEffect="explode">
								<p:panelGrid id="msrmntPanel" columns="2"
									columnClasses="label, value">
									<p:outputLabel value="Measurment:" for="msrmntName" />
									<p:autoComplete id="msrmntName" required="true"
										requiredMessage="Measurment name is manadotry."
										value="#{tkMsrmntView.service.selected.measurment}"
										completeMethod="#{tkMsrmntView.completeMeasurment}" var="tk"
										itemLabel="#{tk.name}" itemValue="#{tk}" forceSelection="true"
										maxResults="12" converter="measurmentConveter">
										<p:tooltip for="msrmntName" value="#{tk.description}" />
									</p:autoComplete>

									<p:outputLabel value="Numrical Value:" for="msrmntNumVal" />
									<p:spinner id="msrmntNumVal" stepFactor="0.1"
										value="#{tkMsrmntView.service.selected.numricalValue}" />
									<p:outputLabel value="Text Value:" for="msrmntTxtVal" />
									<p:inputText id="msrmntTxtVal"
										value="#{tkMsrmntView.service.selected.textualValue}" />
									<p:outputLabel value="Notes:" for="msrmntNotes" />
									<p:inputTextarea id="msrmntNotes"
										value="#{tkMsrmntView.service.selected.notes}" maxlength="210"
										placeholder="notes" />
								</p:panelGrid>
								<f:facet name="footer">
									<p:commandButton id="msrmntSave" value="Save" icon="fa fa-save"
										oncomplete="handelMsrmntSaveRequest(xhr, status, args)"
										process="msrmntPanel, @this"
										actionListener="#{tkMsrmntView.onSaveButtonClicked}"
										update="msrmntPanel, msrmntFrm:dtId, msrmntFrm:msgs" />
									<p:commandButton id="msrmntCancel" value="Cancel"
										process="@this"
										update="msrmntPanel, msrmntFrm:dtId, msrmntFrm:msgs"
										actionListener="#{tkMsrmntView.onCancelButtonClicked}"
										icon="fa fa-remove" oncomplete="PF('msrmntDlgWv').hide()">
										<p:resetInput target="msrmntPanel" />
									</p:commandButton>
								</f:facet>
							</p:dialog>
							<script>
								function handelMsrmntSaveRequest(xhr, status,
										args) {
									if (args.validationFailed) {
										PF('msrmntDlgWv').jq.effect("shake", {
											times : 5
										}, 100);
									} else {
										PF('msrmntDlgWv').hide();
									}
								}
							</script>
						</h:form>


					</p:panel>
					<p:panel id="diaganosis" header="diaganosis">cont</p:panel>
					<p:panel id="treatments" header="treatments">cont</p:panel>
					<p:panel id="orders" header="orders">cont</p:panel>
					<p:panel id="documents" header="documents">cont</p:panel>
				</p:dashboard>

				<div style="clear: both" />
			</div>
			<h:form id="confirmDlg">
				<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
					<p:commandButton value="Yes" type="button"
						styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
					<p:commandButton value="No" type="button"
						styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
				</p:confirmDialog>
			</h:form>
		</p:panel>
	</ui:define>

</ui:composition>
</html>
